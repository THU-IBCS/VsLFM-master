train_dataset:
  dataset:
    name: paired-image-folders
    args:
      root_path_1: /media/liuyv/denseTubes/x3_microtubeSim
      root_path_2: /media/liuyv/denseTubes/GT_microtubeSim
      repeat: 18
      first_k: 130
      last_k: 5
      cache: in_memory
  wrapper:
    name: rlfm-vcdnet
    args:
      inp_size: 120
      volume_depth : 101
      # scale_max: 4
      # augment: true
      # sample_q: 2304
  batch_size: 1

val_dataset:
  dataset:
    name: paired-image-folders
    args:
      root_path_1: /media/liuyv/denseTubes/x3_microtubeSim
      root_path_2: /media/liuyv/denseTubes/GT_microtubeSim
      repeat: 1
      first_k: 200
      last_k: 1
      cache: in_memory
  wrapper:
    name: rlfm-vcdnet
    args:
      inp_size: 120
      volume_depth : 101
      # scale_max: 4
      # sample_q: 2304
  batch_size: 1

# data_norm:
#   inp: {sub: [0.5], div: [0.5]}
#   gt: {sub: [0.5], div: [0.5]}

model:
  name: rlfm
  args:
    encoder_spec:
      name: vsreconnet
      args:
        inChannels : 169
        outChannels : 101
    # imnet_spec:
    #   name: mlp
    #   args:
    #     out_dim: 3
    #     hidden_list: [256, 256, 256, 256]

optimizer:
  name: adam
  args:
    lr: 1.e-4
epoch_max: 600
# multi_step_lr:
#   milestones: [40, 80, 120, 160]
#   gamma: 0.5

loss_fn: 'nn.MSELoss()'

epoch_val: 1
epoch_save: 100
resume: /home/lab532/kimchange/rlfm/save/_train_vsreconnet_x3_microtubes_20221025/epoch-last.pth